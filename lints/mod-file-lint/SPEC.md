# mod-file-lint 仕様

## 目的

- Rust 2018 モジュール構成に揃えるため、旧式の `mod.rs` を用いたモジュール定義を検出して移行を促す。
- ディレクトリが深くても `foo.rs` + `foo/` 構成を徹底し、ソースツリー全体の一貫性を守る。

## ルール

- ファイル名が `mod.rs` のソースファイルを検出したら違反とみなす。
- `#[allow(mod_file::no_mod_rs)]` などで明示的に無効化されている場合のみ例外とする。
- `target/` やビルド生成物など、ローカルディスク上の一時ファイルは対象外。（`rustc` が `LocalPath` として扱っているファイルのみ検査する。）

## 推奨される修正手順

1. 対象の `mod.rs` を `parent.rs` へリネームする (`git mv foo/mod.rs foo.rs`).
2. 既存のサブモジュール定義 (`mod bar;`) は `foo.rs` 内に移動する。
3. 親モジュール側の `mod foo;` 宣言は変更不要。ビルドエラーが出た場合は `foo.rs` のパスと `mod` 宣言の整合性を確認する。
4. プロダクトコード内では `mod.rs` が存在しないことを CI で保証する。

## 診断メッセージ指針

- 違反検出時は `mod.rs` をハイライトし、対象ファイルを `note` で明示する。
- `help` にはリネーム手順を提示し、必要に応じてサブモジュール移行のポイントを `AI向けアドバイス` として追加する。
